!function(){"use strict";function t(t,e){return document.currentScript.getAttribute("data-"+t)||e}const e=t("page-url",window.location.href.replace(/#.*$/,"")),n=t("add-urls",void 0),o=t("data-id","webmentions"),r=t("wordcount"),s=t("max-webmentions",100),i=t("prevent-spoofing")?"wm-source":"url",a=t("sort-by","published"),c=t("sort-dir","up"),l={"in-reply-to":"replied","like-of":"liked","repost-of":"reposted","bookmark-of":"bookmarked","mention-of":"mentioned",rsvp:"RSVPed","follow-of":"followed"};function u(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;")}function d(t){let e='<a rel="nofollow ugc" title="'+u(t.author&&t.author.name?t.author.name:t.url.split("/")[2])+" "+(l[t["wm-property"]]||"reacted")+'" href="'+t[i]+'">';return t.author&&t.author.photo&&(e+='<img class="webmention__author__img aspect-square w-14" src="'+u(t.author.photo)+'">'),e+="</a>"}function p(t){return t.substr(t.indexOf("//"))}function f(t){const e=[],n={};return t.forEach(function(t){const o=p(t.url);n[o]||(e.push(t),n[o]=!0)}),e}function m(t){let e='<h2>Webmentions</h2><ul class="comments p-0">';return t.forEach(function(t){var n;let o,s;if(e+='<li class="rounded-md p-6 list-style-none bg-vibrant/20 dark:bg-slate/70 shadow-md my-5 max-w-[52rem]"><div class="webmention">',e+='<div class="webmention__meta flex flex-row justify-start items-center gap-5">',e+=d(t),e+='<div><strong class="block">',t.author&&t.author.name?e+=u(t.author.name):e+=u(t.url.split("/")[2]),e+='</strong>\x3c!--<span class="block">'+(n=t.published,'<span class="webmention__date">'+new Date(n).toString().substr(0,15)+"</span>")+"</span>--\x3e</div>",e+="</div>",t.content&&t.content.text){let e=u(t.content.text);if(r){let t=e.replace(/\s+/g," ").split(" ",r+1);t.length>r&&(t[r-1]+="&hellip;",e=(t=t.slice(0,r)).join(" "))}o="text",s=e}else o="name",s="(mention)";e+='<div class="webmention__content mt-2 '+o+'">'+s+"</div>",e+="</div></li>"}),e}window.addEventListener("load",function(){const t=document.getElementById(o);if(!t)return;const r=[p(e)];n&&n.split("|").forEach(function(t){r.push(p(t))});let i="https://webmention.io/api/mentions.jf2?per-page="+s+"&sort-by="+a+"&sort-dir="+c;r.forEach(function(t){i+="&target[]="+encodeURIComponent("http:"+t)+"&target[]="+encodeURIComponent("https:"+t)}),function(t,e){if(window.fetch)window.fetch(t).then(function(t){return t.status>=200&&t.status<300?Promise.resolve(t):Promise.reject(new Error(t.statusText))}).then(function(t){return t.json()}).then(e).catch(function(t){console.error("Request failed",t)});else{const t=new XMLHttpRequest;t.onload=function(t){e(JSON.parse(t))},t.onerror=function(t){console.error("Request failed",t)}}}(i,function(e){let n="";const o=[],r=[],s={"in-reply-to":o,"like-of":r,"repost-of":r,"bookmark-of":r,"mention-of":o,rsvp:o};e.children.forEach(function(t){const e=s[t["wm-property"]];e&&e.push(t)}),o.length>0&&(n+=m(f(o))),r.length>0&&(n+=function(t){let e='<h2>Appreciation</h2><ul class="reacts p-0">';return t.forEach(function(t){e+='<li class="rounded-md p-6 list-style-none bg-vibrant/20 dark:bg-slate/70 shadow-md my-5 max-w-[52rem] mx-auto"><div class="webmention">',e+=d(t)}),e}(f(r))),t.innerHTML=n})})}();